language: node_js
node_js:
- '8'
branches:
  only:
  - master
dist: trusty
services:
- mongodb
- redis-server
env:
- NODE_ENV=ci PORT=3000
cache:
  directories:
  - node_modules
  - client/node_modules
install:
- npm install
- npm run build
script:
- nohup npm run start &
- sleep 5
- npm run test
deploy:
  provider: heroku
  app:
    master: advanced-node
    production: advanced-node
  api_key:
    secure: jHhMfDr/flOosZKARgm0mmTS8ZI4H9JsRPH43i27OWigaS/1DnAhrhVTQj/A0OJJCo/iTxIZmU7G6yftTqvSHVed9BMhRMPbHw332ZFFtRebGAZCRllhdNjfSgJXgCJiQpq2Z3x4Hvcm/az55gxklE3Pb2HmZwx3mIfd369heuuURLaO7Jh7VZ18vaRg8DsZi7/L5CK4lD89WpId+GU7cOv2AsVcSJpVFEhZ37y8OJSdml27iJEY/AEn7KJcJbpiW4itCk+9aEy0ABLHYIxpZrzQ/keufG2T95yPCVSseuYl1vxMFw+7xAHHI5bklAjgfET2cwJw1RxlMuhqNa5sXPTWlS+daW88VNGFyBgeVmDo6JA6F76V9S3kEYt3BosyCccH8JgLJ0HqBF0bgx/xhCCBVxaMcC9gQfty2Yic6pEGPufNvgcSzv+U+bhWAm+k9xsB30PHsBbgNY3G6s/BME/tT5mt5PxxIir40UQgpDolekitzWiXIpoG6/hKNgkYzOclCsIaRgwGdMv85YInQxogMtqPIGamENL11KaL5P75eLfdEv68ZMksPEtUk9hsC3BczyG+f5rCuqO5a2MhbjWEAf7MXxtPhkkKBhhYcP4i4Z4jFJ6qAGnbzvwD6AFsAOpCHMdn0sZUMNVm/mZW+aj4KnHzt0+BaG47gQIuCOE=
